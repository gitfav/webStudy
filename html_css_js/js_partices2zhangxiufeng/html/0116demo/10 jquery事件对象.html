<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<style type="text/css">
	*{
		padding: 0;
		margin:0;
	}
	#box{
		width: 300px;
		height: 200px;
		background: purple;
		position: absolute;
		left: 150px;
		top: 100px;
	}
</style>
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript">
	$(function(){

		// 给#box加单击事件
		// $('#box').click(function(ev) {
		// 	// 获得鼠标的位置
		// 	alert(ev.clientX);
		// });

		var box = $('#box');
		// 给box加鼠标按下事件
		box.mousedown(function(ev) {
			// 获得鼠标当前的位置
			var mouse_old_left = ev.clientX;
			var mouse_old_top  = ev.clientY;
			// 获得box的位置
			var box_old_left = box.position().left;
			var box_old_top = box.position().top;
			// 给document加鼠标移动事件
			$(document).mousemove(function(e){
				// 获得鼠标最新的位置
				var mouse_new_left = e.clientX;
				var mouse_new_top = e.clientY;
				// 计算鼠标移动的距离
				var diff_left = mouse_new_left - mouse_old_left;
				var diff_top = mouse_new_top - mouse_old_top;
				// 计算box最新的位置
				var box_new_top = box_old_top + diff_top;
				var box_new_left = box_old_left + diff_left;
				// 将box的位置赋值回去
				$('#box').css({'left':box_new_left+'px','top':box_new_top+'px'})
			})
		});


		// 给box加鼠标抬起事件
		box.mouseup(function() {
			// 解除掉document身上的mousemove事件
			$(document).off('mousemove');
		});


	})
</script>
</head>

<body>


<div id="box"></div>

</body>
</html>
